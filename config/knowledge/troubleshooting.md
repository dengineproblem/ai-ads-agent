# Troubleshooting Guide

Решения типичных проблем с Facebook Ads.

---

## Проблемы с аккаунтом

### Аккаунт заблокирован

**Симптомы:**
- "Ad account disabled"
- Нельзя создавать рекламу

**Действия:**
1. Проверить причину в Business Manager
2. Подать апелляцию через Support
3. НЕ создавать новый аккаунт (усугубит проблему)

### Лимит расходов достигнут

**Симптомы:**
- Реклама остановилась
- "Spending limit reached"

**Действия:**
1. Проверить `get_account_info()` → spending_cap
2. Увеличить лимит в Business Manager
3. Или подождать сброса (обычно 1-го числа)

---

## Проблемы с кампаниями

### Кампания не тратит бюджет

**Возможные причины:**

| Причина | Как проверить | Решение |
|---------|---------------|---------|
| Аудитория слишком узкая | Audience size < 100K | Расширить таргетинг |
| Низкая ставка | Bid ниже конкурентов | Увеличить bid или переключить на auto |
| Плохой креатив | CTR < 0.5% | Обновить креативы |
| Проблема с pixel | Events не приходят | Проверить pixel setup |
| Learning limited | Статус в Ads Manager | Увеличить бюджет или расширить аудиторию |

### "Learning Limited" статус

**Что значит:**
- Adset получает менее 50 конверсий за 7 дней
- Алгоритм не может оптимизироваться эффективно

**Решения:**
1. Увеличить бюджет: `50 * CPA / 7` минимум
2. Расширить аудиторию
3. Использовать более ранние конверсии (clicks вместо purchases)
4. Объединить несколько adsets в один

---

## Проблемы с креативами

### Креатив отклонен

**Частые причины:**

| Причина | Описание | Решение |
|---------|----------|---------|
| Text overlay | > 20% текста на изображении | Убрать текст с картинки |
| Before/After | Нельзя показывать результаты | Убрать сравнения |
| Personal attributes | "Ты толстый?" | Переформулировать |
| Prohibited content | Алкоголь, оружие, и т.д. | Соблюдать политики |
| Misleading claims | "Гарантированный результат" | Убрать гарантии |

### Низкий CTR на креативе

**Чек-лист улучшения:**
- [ ] Заголовок привлекает внимание?
- [ ] Картинка выделяется в ленте?
- [ ] CTA понятен?
- [ ] Оффер ценный для аудитории?
- [ ] Текст короткий и понятный?

---

## Проблемы с конверсиями

### Pixel не видит конверсии

**Диагностика:**
1. Проверить Events Manager
2. Использовать Facebook Pixel Helper
3. Проверить GTM/код на сайте

**Решения:**
- Установить pixel через Conversions API (CAPI)
- Проверить события через Test Events
- Убедиться что pixel_id правильный

### Много кликов, мало конверсий

**Возможные причины:**

| Проблема | Признаки | Решение |
|----------|----------|---------|
| Медленный лендинг | LP View Rate < 60% | Оптимизировать скорость |
| Нерелевантный трафик | CTR высокий, CR низкий | Уточнить таргетинг |
| Плохой лендинг | Высокий bounce rate | Переделать лендинг |
| Сломанная форма | Нет submit events | Починить форму |

---

## Проблемы с аудиториями

### Audience overlap

**Симптомы:**
- Adsets конкурируют между собой
- Высокий CPM
- Нестабильные результаты

**Решения:**
1. Проверить overlap в Audience Insights
2. Объединить похожие аудитории
3. Использовать exclusions

### Lookalike не работает

**Причины:**
- Source audience слишком маленькая (< 1000)
- Source audience некачественная
- Слишком широкий ratio

**Решения:**
1. Увеличить source до 1000+ людей
2. Использовать quality events (purchases > leads > clicks)
3. Начать с 1% ratio

---

## API ошибки

### Error 17: Rate limit

**Причина:** Слишком много запросов к API

**Решение:**
- Подождать 1-5 минут
- Использовать batch requests
- Кэшировать результаты

### Error 100: Invalid parameter

**Причина:** Неправильные параметры запроса

**Решение:**
- Проверить формат account_id (act_XXXX)
- Проверить что объект существует
- Проверить permissions

### Error 190: Invalid access token

**Причина:** Токен истек или невалидный

**Решение:**
- Обновить токен через `get_login_link()`
- Проверить permissions токена

### Error 1487390: Ad set not active

**Причина:** Попытка изменить неактивный adset

**Решение:**
- Сначала активировать (`resume_adset`)
- Или изменить в paused состоянии

---

## Чек-лист диагностики

При любой проблеме:

1. **Проверить статус объектов**
   - Аккаунт активен?
   - Кампания активна?
   - Adset/Ad активны?

2. **Проверить бюджет**
   - Есть ли бюджет?
   - Не достигнут лимит?

3. **Проверить аудиторию**
   - Размер достаточный?
   - Нет overlap?

4. **Проверить креатив**
   - Одобрен?
   - CTR нормальный?

5. **Проверить настройки**
   - Расписание правильное?
   - Placements настроены?
   - Bid strategy подходит?

---

## Полезные MCP вызовы для диагностики

```python
# Статус аккаунта
get_account_info(account_id="act_XXX")

# Статус кампаний
get_campaigns(account_id="act_XXX", status_filter="ACTIVE")

# Метрики за сегодня
get_insights(object_id="act_XXX", time_range="today")

# Детали adset
get_adset_details(adset_id="XXX")

# Креативы объявления
get_ad_creatives(ad_id="XXX")
```
